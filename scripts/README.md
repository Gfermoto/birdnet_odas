# –°–∫—Ä–∏–ø—Ç—ã –ø—Ä–æ–µ–∫—Ç–∞

–≠—Ç–∞ –ø–∞–ø–∫–∞ —Å–æ–¥–µ—Ä–∂–∏—Ç –≤—Å–µ —Å–∫—Ä–∏–ø—Ç—ã, –∏—Å–ø–æ–ª—å–∑—É–µ–º—ã–µ –¥–ª—è –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –∏ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è —Å–∏—Å—Ç–µ–º–æ–π BirdNET-Go —Å ReSpeaker USB Mic Array –Ω–∞ NanoPi M4B.

## –°–ø–∏—Å–æ–∫ —Å–∫—Ä–∏–ø—Ç–æ–≤

### ReSpeaker

#### `respeaker-tune.sh`
**–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ:** –ü—Ä–∏–º–µ–Ω—è–µ—Ç –æ–ø—Ç–∏–º–∞–ª—å–Ω—ã–µ DSP –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –¥–ª—è ReSpeaker USB Mic Array.

**–ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ:**
```bash
sudo /usr/local/bin/respeaker-tune.sh
```

**–ß—Ç–æ –¥–µ–ª–∞–µ—Ç:**
- –ù–∞—Å—Ç—Ä–∞–∏–≤–∞–µ—Ç HPF (High-Pass Filter) –Ω–∞ 180 –ì—Ü
- –í–∫–ª—é—á–∞–µ—Ç —à—É–º–æ–ø–æ–¥–∞–≤–ª–µ–Ω–∏–µ (—Å—Ç–∞—Ü–∏–æ–Ω–∞—Ä–Ω–æ–µ, –Ω–µ—Å—Ç–∞—Ü–∏–æ–Ω–∞—Ä–Ω–æ–µ, —Ç—Ä–∞–Ω–∑–∏–µ–Ω—Ç—ã)
- –ù–∞—Å—Ç—Ä–∞–∏–≤–∞–µ—Ç AGC —Å –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ–º —É—Å–∏–ª–µ–Ω–∏—è
- –û—Ç–∫–ª—é—á–∞–µ—Ç VAD (–Ω–µ –Ω—É–∂–µ–Ω –¥–ª—è –ø—Ç–∏—Ü)
- –û—Ç–∫–ª—é—á–∞–µ—Ç LED –∫–æ–ª—å—Ü–æ –¥–ª—è —Å–Ω–∏–∂–µ–Ω–∏—è —ç–Ω–µ—Ä–≥–æ–ø–æ—Ç—Ä–µ–±–ª–µ–Ω–∏—è –∏ —ç–ª–µ–∫—Ç—Ä–æ–º–∞–≥–Ω–∏—Ç–Ω—ã—Ö –ø–æ–º–µ—Ö

**–ê–≤—Ç–æ–∑–∞–ø—É—Å–∫:** –°–æ–∑–¥–∞–µ—Ç—Å—è systemd —Å–µ—Ä–≤–∏—Å `respeaker-tune.service` –¥–ª—è –ø—Ä–∏–º–µ–Ω–µ–Ω–∏—è –Ω–∞—Å—Ç—Ä–æ–µ–∫ –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ.

---

#### `respeaker_loopback.sh`
**–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ:** –ü–µ—Ä–µ–¥–∞–µ—Ç –∞—É–¥–∏–æ —Å ReSpeaker —á–µ—Ä–µ–∑ Log-MMSE —à—É–º–æ–ø–æ–¥–∞–≤–ª–µ–Ω–∏–µ –∏ SoX –≤ ALSA loopback —É—Å—Ç—Ä–æ–π—Å—Ç–≤–æ –¥–ª—è BirdNET-Go.

**–ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ:**
```bash
# –ó–∞–ø—É—Å–∫–∞–µ—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —á–µ—Ä–µ–∑ systemd —Å–µ—Ä–≤–∏—Å
systemctl status respeaker-loopback.service
```

**–ß—Ç–æ –¥–µ–ª–∞–µ—Ç:**
- –ß–∏—Ç–∞–µ—Ç –∞—É–¥–∏–æ —Å ReSpeaker (16kHz, 6 –∫–∞–Ω–∞–ª–æ–≤)
- –ü—Ä–∏–º–µ–Ω—è–µ—Ç Log-MMSE —à—É–º–æ–ø–æ–¥–∞–≤–ª–µ–Ω–∏–µ (–∏–∑–≤–ª–µ–∫–∞–µ—Ç –∫–∞–Ω–∞–ª 0, –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç –Ω–∞ 16kHz)
- –†–µ—Å–µ–º–ø–ª–∏—Ä—É–µ—Ç –¥–æ 48kHz —á–µ—Ä–µ–∑ SoX
- –ó–∞–ø–∏—Å—ã–≤–∞–µ—Ç –≤ ALSA loopback device 1 (playback)
- –õ–æ–≥–∏—Ä—É–µ—Ç –æ—à–∏–±–∫–∏ –≤ `/var/log/birdnet-pipeline/errors.log`
- –í–µ–¥–µ—Ç —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É –≤ `/var/log/birdnet-pipeline/pipeline_stats.json`
- –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø–µ—Ä–µ–∑–∞–ø—É—Å–∫–∞–µ—Ç—Å—è –ø—Ä–∏ –æ—à–∏–±–∫–∞—Ö —Å —ç–∫—Å–ø–æ–Ω–µ–Ω—Ü–∏–∞–ª—å–Ω–æ–π –∑–∞–¥–µ—Ä–∂–∫–æ–π

**–ê–≤—Ç–æ–∑–∞–ø—É—Å–∫:** –°–æ–∑–¥–∞–µ—Ç—Å—è systemd —Å–µ—Ä–≤–∏—Å `respeaker-loopback.service` –¥–ª—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–≥–æ –∑–∞–ø—É—Å–∫–∞ –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ.

**–û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏:**
- Nice: -10 (–≤—ã—Å–æ–∫–∏–π –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç)
- CPU Scheduling: FIFO —Å –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç–æ–º 50
- IO Weight: 100
- OOM Score Adjust: -500 (–∑–∞—â–∏—Ç–∞ –æ—Ç OOM killer)

---

#### `log_mmse_processor.py`
**–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ:** Log-MMSE —à—É–º–æ–ø–æ–¥–∞–≤–ª–µ–Ω–∏–µ –¥–ª—è –∑–∞–ø–∏—Å–∏ –ø—Ç–∏—Ü (–∞–ª–≥–æ—Ä–∏—Ç–º Ephraim & Malah, 1985).

**–ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ:**
```bash
# –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –≤ respeaker_loopback.sh
# –ò–ª–∏ –≤—Ä—É—á–Ω—É—é –¥–ª—è –æ–±—Ä–∞–±–æ—Ç–∫–∏ —Ñ–∞–π–ª–æ–≤:
python3 log_mmse_processor.py < input.raw > output.raw
```

**–ß—Ç–æ –¥–µ–ª–∞–µ—Ç:**
- –ß–∏—Ç–∞–µ—Ç 6-–∫–∞–Ω–∞–ª—å–Ω—ã–π interleaved –ø–æ—Ç–æ–∫ (16kHz, S16_LE)
- –ò–∑–≤–ª–µ–∫–∞–µ—Ç –∫–∞–Ω–∞–ª 0 (beamformed)
- –ü—Ä–∏–º–µ–Ω—è–µ—Ç Log-MMSE —à—É–º–æ–ø–æ–¥–∞–≤–ª–µ–Ω–∏–µ:
  - STFT —Å frame_size=1024, hop_size=512, Hann window
  - Decision-Directed a priori SNR estimation (alpha=0.95)
  - –ê–¥–∞–ø—Ç–∏–≤–Ω–∞—è –æ—Ü–µ–Ω–∫–∞ —à—É–º–∞ (–ø–µ—Ä–≤—ã–µ 10 frames)
  - Log-MMSE gain function —Å exponential integral
- –í—ã–¥–∞–µ—Ç –º–æ–Ω–æ –ø–æ—Ç–æ–∫ (16kHz, S16_LE)

**–ü–∞—Ä–∞–º–µ—Ç—Ä—ã:**
- `FRAME_SIZE = 1024` - —Ä–∞–∑–º–µ—Ä FFT frame (–ª—É—á—à–µ–µ —á–∞—Å—Ç–æ—Ç–Ω–æ–µ —Ä–∞–∑—Ä–µ—à–µ–Ω–∏–µ –¥–ª—è –ø—Ç–∏—Ü)
- `HOP_SIZE = 512` - —à–∞–≥ –º–µ–∂–¥—É frames (50% overlap)
- `ALPHA = 0.70` - Decision-Directed smoothing, –±–∞–ª–∞–Ω—Å –º–µ–∂–¥—É –ø–æ–¥–∞–≤–ª–µ–Ω–∏–µ–º —à—É–º–∞ –∏ –º–∏–Ω–∏–º–∏–∑–∞—Ü–∏–µ–π –º—É–∑—ã–∫–∞–ª—å–Ω—ã—Ö –∞—Ä—Ç–µ—Ñ–∞–∫—Ç–æ–≤
- `NOISE_FRAMES = 15` - –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ frames –¥–ª—è –Ω–∞—á–∞–ª—å–Ω–æ–π –æ—Ü–µ–Ω–∫–∏ —à—É–º–∞

**–ó–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏:** `python3-scipy`, `python3-numpy`

---

#### `disable_led_ring.py`
**–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ:** –û—Ç–∫–ª—é—á–∞–µ—Ç LED –∫–æ–ª—å—Ü–æ –Ω–∞ ReSpeaker USB 4 Mic Array –¥–ª—è —Å–Ω–∏–∂–µ–Ω–∏—è —ç–Ω–µ—Ä–≥–æ–ø–æ—Ç—Ä–µ–±–ª–µ–Ω–∏—è –∏ —ç–ª–µ–∫—Ç—Ä–æ–º–∞–≥–Ω–∏—Ç–Ω—ã—Ö –ø–æ–º–µ—Ö.

**–ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ:**
```bash
# –ó–∞–ø—É—Å–∫–∞–µ—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —á–µ—Ä–µ–∑ respeaker-tune.sh
# –ò–ª–∏ –≤—Ä—É—á–Ω—É—é:
python3 /usr/local/bin/disable_led_ring.py
```

**–ß—Ç–æ –¥–µ–ª–∞–µ—Ç:**
- –ò—Å–ø–æ–ª—å–∑—É–µ—Ç –±–∏–±–ª–∏–æ—Ç–µ–∫—É `pixel-ring` –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è LED –∫–æ–ª—å—Ü–æ–º
- –í—ã–∫–ª—é—á–∞–µ—Ç –≤—Å–µ —Å–≤–µ—Ç–æ–¥–∏–æ–¥—ã –Ω–∞ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–µ
- –°–Ω–∏–∂–∞–µ—Ç —ç–Ω–µ—Ä–≥–æ–ø–æ—Ç—Ä–µ–±–ª–µ–Ω–∏–µ (–≤–∞–∂–Ω–æ –ø—Ä–∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–∏ USB-–∏–∑–æ–ª—è—Ç–æ—Ä–∞ —Å –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–Ω—ã–º —Ç–æ–∫–æ–º)
- –£–º–µ–Ω—å—à–∞–µ—Ç —ç–ª–µ–∫—Ç—Ä–æ–º–∞–≥–Ω–∏—Ç–Ω—ã–µ –ø–æ–º–µ—Ö–∏ –æ—Ç –®–ò–ú-—É–ø—Ä–∞–≤–ª–µ–Ω–∏—è —Å–≤–µ—Ç–æ–¥–∏–æ–¥–∞–º–∏

**–ó–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏:** `pixel-ring` (—É—Å—Ç–∞–Ω–æ–≤–∫–∞: `pip3 install pixel-ring`)

**–ö–æ–≥–¥–∞ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å:** –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ —Å–∏—Å—Ç–µ–º—ã. –û—Å–æ–±–µ–Ω–Ω–æ –≤–∞–∂–Ω–æ –ø—Ä–∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–∏ USB-–∏–∑–æ–ª—è—Ç–æ—Ä–∞ B505S (–∏–ª–∏ ADUM3160), –∫–æ—Ç–æ—Ä—ã–π —Ä–∞—Å—Å—á–∏—Ç–∞–Ω –Ω–∞ —Ç–æ–∫ –¥–æ 250 –º–ê.

---

### –ü—Ä–æ–≤–µ—Ä–∫–∞ –∏ –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞

#### `check_gain.sh`
**–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ:** –ü—Ä–æ–≤–µ—Ä—è–µ—Ç —Ç–µ–∫—É—â–∏–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ AGC (Auto Gain Control) –Ω–∞ ReSpeaker.

**–ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ:**
```bash
/usr/local/bin/check_gain.sh
# –ò–ª–∏ –∏–∑ –ø—Ä–æ–µ–∫—Ç–∞:
bash scripts/check_gain.sh
```

**–ß—Ç–æ –ø—Ä–æ–≤–µ—Ä—è–µ—Ç:**
- –°—Ç–∞—Ç—É—Å AGC (–≤–∫–ª—é—á–µ–Ω/–≤—ã–∫–ª—é—á–µ–Ω)
- –ú–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–µ —É—Å–∏–ª–µ–Ω–∏–µ (AGCMAXGAIN)
- –ñ–µ–ª–∞–µ–º—ã–π —É—Ä–æ–≤–µ–Ω—å (AGCDESIREDLEVEL)
- –í—Ä–µ–º—è —Ä–µ–∞–∫—Ü–∏–∏ AGC (AGCTIME)
- –°—Ä–∞–≤–Ω–µ–Ω–∏–µ —Å –æ–∂–∏–¥–∞–µ–º—ã–º–∏ –∑–Ω–∞—á–µ–Ω–∏—è–º–∏ –∏–∑ respeaker-tune.sh

**–ö–æ–≥–¥–∞ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å:** –î–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ –ø—Ä–∞–≤–∏–ª—å–Ω–æ—Å—Ç–∏ –Ω–∞—Å—Ç—Ä–æ–µ–∫ AGC –∏–ª–∏ –ø–æ—Å–ª–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ DSP.

---

#### `check_audio_devices.sh`
**–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ:** –ü—Ä–æ–≤–µ—Ä—è–µ—Ç, –∫–∞–∫–∏–µ –∞—É–¥–∏–æ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞ –∑–∞–Ω—è—Ç—ã –∏ –ø—Ä–∞–≤–∏–ª—å–Ω–æ –ª–∏ –Ω–∞—Å—Ç—Ä–æ–µ–Ω–∞ —Å–∏—Å—Ç–µ–º–∞.

**–ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ:**
```bash
/usr/local/bin/check_audio_devices.sh
```

**–ß—Ç–æ –ø—Ä–æ–≤–µ—Ä—è–µ—Ç:**
- –ó–∞–Ω—è—Ç—ã–µ ALSA —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞
- –ö–∞–∫–æ–µ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–æ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç BirdNET-Go
- –ó–∞–Ω—è—Ç –ª–∏ device 0 (capture –¥–ª—è BirdNET-Go) - –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å –∑–∞–Ω—è—Ç BirdNET-Go
- –†–∞–±–æ—Ç–∞–µ—Ç –ª–∏ –ø—Ä–æ—Ü–µ—Å—Å respeaker-loopback (–ø–∏—à–µ—Ç –≤ device 1 –¥–ª—è playback)

**–ö–æ–≥–¥–∞ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å:** –ü–æ—Å–ª–µ –ø–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∫–∏ –∏–ª–∏ –ø—Ä–∏ –ø—Ä–æ–±–ª–µ–º–∞—Ö —Å –∞—É–¥–∏–æ.

**–í–∞–∂–Ω–æ:** –ü—Ä–∞–≤–∏–ª—å–Ω–æ–µ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–æ –¥–ª—è BirdNET-Go - —ç—Ç–æ **–¢–†–ï–¢–¨–ï —É—Å—Ç—Ä–æ–π—Å—Ç–≤–æ –≤ —Å–ø–∏—Å–∫–µ** (`:2,0`), –∏–∑ –∫–æ—Ç–æ—Ä–æ–≥–æ BirdNET-Go —á–∏—Ç–∞–µ—Ç –¥–∞–Ω–Ω—ã–µ.

---

#### `diagnose_clicks.sh`
**–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ:** –î–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞ —â–µ–ª—á–∫–æ–≤ –≤ –∞—É–¥–∏–æ –∑–∞–ø–∏—Å–∏.

**–ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ:**
```bash
/usr/local/bin/diagnose_clicks.sh
# –ò–ª–∏ –∏–∑ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏—è –ø—Ä–æ–µ–∫—Ç–∞
./scripts/diagnose_clicks.sh
```

**–ß—Ç–æ –ø—Ä–æ–≤–µ—Ä—è–µ—Ç:**
- –°–∏—Å—Ç–µ–º–Ω—ã–µ —Ç–∞–π–º–µ—Ä—ã (–ø–µ—Ä–∏–æ–¥–∏—á–µ—Å–∫–∏–µ –∑–∞–¥–∞—á–∏)
- Cron –∑–∞–¥–∞—á–∏
- USB –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∏ –ø–∏—Ç–∞–Ω–∏–µ
- USB –æ—à–∏–±–∫–∏
- ALSA –±—É—Ñ–µ—Ä—ã
- –ü—Ä–æ—Ü–µ—Å—Å—ã –∞—É–¥–∏–æ –ø–∞–π–ø–ª–∞–π–Ω–∞
- CPU –Ω–∞–≥—Ä—É–∑–∫—É
- Loopback —É—Å—Ç—Ä–æ–π—Å—Ç–≤–æ
- –ù–∞—Å—Ç—Ä–æ–π–∫–∏ udev –¥–ª—è USB
- –ù–∞—Å—Ç—Ä–æ–π–∫–∏ ALSA
- –°—Ç–∞—Ç—É—Å —Å–µ—Ä–≤–∏—Å–∞ respeaker-loopback
- –õ–æ–≥–∏ —Å–µ—Ä–≤–∏—Å–∞ –Ω–∞ –Ω–∞–ª–∏—á–∏–µ –æ—à–∏–±–æ–∫

**–ö–æ–≥–¥–∞ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å:** –ü—Ä–∏ –ø–æ—è–≤–ª–µ–Ω–∏–∏ —â–µ–ª—á–∫–æ–≤ –≤ –∑–∞–ø–∏—Å–∏ (–ø–µ—Ä–∏–æ–¥–∏—á–µ—Å–∫–∏—Ö –∏–ª–∏ –æ—Ç –≤–Ω–µ—à–Ω–∏—Ö –∏—Å—Ç–æ—á–Ω–∏–∫–æ–≤).

---

### –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏

#### `optimize_performance.sh`
**–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ:** –ü—Ä–∏–º–µ–Ω—è–µ—Ç —Ç–æ–ª—å–∫–æ –±–µ–∑–æ–ø–∞—Å–Ω—ã–µ —Å–∏—Å—Ç–µ–º–Ω—ã–µ –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏ –¥–ª—è –∞—É–¥–∏–æ –ø–∞–π–ø–ª–∞–π–Ω–∞.

**–ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ:**
```bash
sudo /usr/local/bin/optimize_performance.sh
```

**–ß—Ç–æ –¥–µ–ª–∞–µ—Ç (—Ç–æ–ª—å–∫–æ –±–µ–∑–æ–ø–∞—Å–Ω—ã–µ –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏):**
- –ù–∞—Å—Ç—Ä–∞–∏–≤–∞–µ—Ç I/O scheduler –Ω–∞ `deadline` –¥–ª—è –≤—Å–µ—Ö –¥–∏—Å–∫–æ–≤
- –£–≤–µ–ª–∏—á–∏–≤–∞–µ—Ç –ª–∏–º–∏—Ç—ã —Ñ–∞–π–ª–æ–≤—ã—Ö –¥–µ—Å–∫—Ä–∏–ø—Ç–æ—Ä–æ–≤ –¥–æ 65536

**–û—Ç–∫–ª—é—á–µ–Ω–æ –¥–ª—è –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏:**
- CPU governor (–º–æ–∂–µ—Ç –≤—ã–∑–≤–∞—Ç—å –ø—Ä–æ–±–ª–µ–º—ã)
- vm.swappiness –∏ vm.dirty_ratio (–º–æ–≥—É—Ç –≤—ã–∑–≤–∞—Ç—å –ø—Ä–æ–±–ª–µ–º—ã –Ω–∞ –º–µ–¥–ª–µ–Ω–Ω—ã—Ö –¥–∏—Å–∫–∞—Ö)
- –°–µ—Ç–µ–≤—ã–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã (–≤—ã–∑—ã–≤–∞–ª–∏ –ø—Ä–æ–±–ª–µ–º—ã —Å —Å–µ—Ç—å—é)
- –ü–∞—Ä–∞–º–µ—Ç—Ä—ã —è–¥—Ä–∞ –¥–ª—è —Ä–µ–∞–ª—å–Ω–æ–≥–æ –≤—Ä–µ–º–µ–Ω–∏ (–±–ª–æ–∫–∏—Ä–æ–≤–∞–ª–∏ –∑–∞–≥—Ä—É–∑–∫—É)

**–ö–æ–≥–¥–∞ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å:** –ü–æ—Å–ª–µ —É—Å—Ç–∞–Ω–æ–≤–∫–∏ —Å–∏—Å—Ç–µ–º—ã –¥–ª—è –ø—Ä–∏–º–µ–Ω–µ–Ω–∏—è –±–µ–∑–æ–ø–∞—Å–Ω—ã—Ö –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–π.

---

#### `collect_metrics.sh`
**–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ:** –°–æ–±–∏—Ä–∞–µ—Ç –º–µ—Ç—Ä–∏–∫–∏ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏ —Å–∏—Å—Ç–µ–º—ã –¥–ª—è –∞–Ω–∞–ª–∏–∑–∞.

**–ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ:**
```bash
# –ó–∞–ø—É—Å–∫–∞–µ—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —á–µ—Ä–µ–∑ systemd —Ç–∞–π–º–µ—Ä –∫–∞–∂–¥—ã–µ 5 –º–∏–Ω—É—Ç
systemctl status collect-metrics.timer

# –ò–ª–∏ –≤—Ä—É—á–Ω—É—é:
/usr/local/bin/collect_metrics.sh
```

**–ß—Ç–æ —Å–æ–±–∏—Ä–∞–µ—Ç:**
- CPU –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ (–æ–±—â–µ–µ –∏ –ø–æ –ø—Ä–æ—Ü–µ—Å—Å–∞–º –ø–∞–π–ø–ª–∞–π–Ω–∞)
- –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –ø–∞–º—è—Ç–∏ (–æ–±—â–µ–µ –∏ –ø–æ –ø—Ä–æ—Ü–µ—Å—Å–∞–º)
- Load average
- –°—Ç–∞—Ç–∏—Å—Ç–∏–∫—É –ø–∞–π–ø–ª–∞–π–Ω–∞ (restarts, errors, uptime)

**–ì–¥–µ —Ö—Ä–∞–Ω—è—Ç—Å—è –º–µ—Ç—Ä–∏–∫–∏:**
- `/var/log/birdnet-pipeline/metrics/YYYYMMDD.json` - –º–µ—Ç—Ä–∏–∫–∏ –ø–æ –¥–Ω—è–º
- –ö–∞–∂–¥–∞—è –∑–∞–ø–∏—Å—å —Å–æ–¥–µ—Ä–∂–∏—Ç timestamp –∏ –≤—Å–µ –º–µ—Ç—Ä–∏–∫–∏ –≤ JSON —Ñ–æ—Ä–º–∞—Ç–µ
- –§–∞–π–ª—ã –æ–≥—Ä–∞–Ω–∏—á–µ–Ω—ã –ø–æ—Å–ª–µ–¥–Ω–∏–º–∏ 1000 –∑–∞–ø–∏—Å—è–º–∏

**–ê–≤—Ç–æ–∑–∞–ø—É—Å–∫:** –°–æ–∑–¥–∞–µ—Ç—Å—è systemd —Ç–∞–π–º–µ—Ä `collect-metrics.timer` –¥–ª—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–≥–æ —Å–±–æ—Ä–∞ –º–µ—Ç—Ä–∏–∫ –∫–∞–∂–¥—ã–µ 5 –º–∏–Ω—É—Ç.

---

#### `install_metrics_service.sh`
**–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ:** –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç systemd —Å–µ—Ä–≤–∏—Å –∏ —Ç–∞–π–º–µ—Ä –¥–ª—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–≥–æ —Å–±–æ—Ä–∞ –º–µ—Ç—Ä–∏–∫.

**–ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ:**
```bash
sudo /usr/local/bin/install_metrics_service.sh
# –ò–ª–∏ –∏–∑ –ø—Ä–æ–µ–∫—Ç–∞:
sudo bash scripts/install_metrics_service.sh
```

**–ß—Ç–æ –¥–µ–ª–∞–µ—Ç:**
- –°–æ–∑–¥–∞–µ—Ç systemd —Å–µ—Ä–≤–∏—Å `collect-metrics.service`
- –°–æ–∑–¥–∞–µ—Ç systemd —Ç–∞–π–º–µ—Ä `collect-metrics.timer` (–∑–∞–ø—É—Å–∫ —á–µ—Ä–µ–∑ 1 –º–∏–Ω—É—Ç—É –ø–æ—Å–ª–µ –∑–∞–≥—Ä—É–∑–∫–∏, –∑–∞—Ç–µ–º –∫–∞–∂–¥—ã–µ 5 –º–∏–Ω—É—Ç)
- –í–∫–ª—é—á–∞–µ—Ç –∏ –∑–∞–ø—É—Å–∫–∞–µ—Ç —Ç–∞–π–º–µ—Ä –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏

**–ö–æ–≥–¥–∞ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å:** –ü–æ—Å–ª–µ —É—Å—Ç–∞–Ω–æ–≤–∫–∏ —Å–∏—Å—Ç–µ–º—ã –¥–ª—è –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–≥–æ —Å–±–æ—Ä–∞ –º–µ—Ç—Ä–∏–∫. –í—ã–∑—ã–≤–∞–µ—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –≤–æ –≤—Ä–µ–º—è –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏—è —Å–∏—Å—Ç–µ–º—ã.

---

### –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –Ω–∞—Å—Ç—Ä–æ–µ–∫

#### `fix_network_dhcp.sh`
**–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ:** –ò—Å–ø—Ä–∞–≤–ª—è–µ—Ç –ø—Ä–æ–±–ª–µ–º—ã —Å –ø–æ–ª—É—á–µ–Ω–∏–µ–º IP —á–µ—Ä–µ–∑ DHCP –Ω–∞ —Ä–æ—É—Ç–µ—Ä–∞—Ö MikroTik.

**–ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ:**
```bash
sudo bash scripts/fix_network_dhcp.sh
```

**–ß—Ç–æ –¥–µ–ª–∞–µ—Ç:**
- –£–≤–µ–ª–∏—á–∏–≤–∞–µ—Ç DHCP —Ç–∞–π–º–∞—É—Ç –¥–æ 120 —Å–µ–∫—É–Ω–¥ (–±—ã–ª–æ 45 —Å–µ–∫—É–Ω–¥)
- –£–≤–µ–ª–∏—á–∏–≤–∞–µ—Ç —Ç–∞–π–º–∞—É—Ç NetworkManager-wait-online –¥–æ 180 —Å–µ–∫—É–Ω–¥
- –û—Ç–∫–ª—é—á–∞–µ—Ç may-fail ‚Äî —Å–∏—Å—Ç–µ–º–∞ –±—É–¥–µ—Ç –∂–¥–∞—Ç—å –ø–æ–ª—É—á–µ–Ω–∏—è IP –∞–¥—Ä–µ—Å–∞
- –ù–∞—Å—Ç—Ä–∞–∏–≤–∞–µ—Ç –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –ø–µ—Ä–µ–ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ

**–ö–æ–≥–¥–∞ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å:** –ï—Å–ª–∏ —Å–∏—Å—Ç–µ–º–∞ –Ω–µ –ø–æ–ª—É—á–∞–µ—Ç IP –∞–¥—Ä–µ—Å –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ (–¥–æ–ª–≥–æ–µ –æ–∂–∏–¥–∞–Ω–∏–µ DHCP –Ω–∞ MikroTik —Ä–æ—É—Ç–µ—Ä–∞—Ö).

**–í–∞–∂–Ω–æ:** –ü–æ—Å–ª–µ –ø—Ä–∏–º–µ–Ω–µ–Ω–∏—è —É–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –Ω–∞ MikroTik –Ω–∞—Å—Ç—Ä–æ–µ–Ω–∞ DHCP reservation –¥–ª—è MAC –∞–¥—Ä–µ—Å–∞ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞.

---

#### `fix_birdnet_device.sh`
**–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ:** –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø—Ä–æ–≤–µ—Ä—è–µ—Ç –∏ –ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–∞–µ—Ç –æ –Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω–æ–º –≤—ã–±–æ—Ä–µ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞ –≤ BirdNET-Go.

**–ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ:**
```bash
# –ó–∞–ø—É—Å–∫–∞–µ—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —á–µ—Ä–µ–∑ systemd —Å–µ—Ä–≤–∏—Å –ø–æ—Å–ª–µ –∑–∞–≥—Ä—É–∑–∫–∏
systemctl status birdnet-device-check.service
```

**–ß—Ç–æ –¥–µ–ª–∞–µ—Ç:**
- –ñ–¥–µ—Ç 15 —Å–µ–∫—É–Ω–¥ –ø–æ—Å–ª–µ –∑–∞–≥—Ä—É–∑–∫–∏ (–¥–ª—è –∑–∞–ø—É—Å–∫–∞ BirdNET-Go)
- –ü—Ä–æ–≤–µ—Ä—è–µ—Ç –∫–æ–Ω—Ñ–∏–≥ –Ω–∞ –Ω–∞–ª–∏—á–∏–µ –Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω–æ–≥–æ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞ `:2,1`
- –í—ã–≤–æ–¥–∏—Ç –ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏–µ, –µ—Å–ª–∏ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–æ –Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω–æ–µ
- –î–∞–µ—Ç –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏ –ø–æ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—é (–≤—ã–±—Ä–∞—Ç—å –¢–†–ï–¢–¨–ï —É—Å—Ç—Ä–æ–π—Å—Ç–≤–æ –≤ —Å–ø–∏—Å–∫–µ - `:2,0`)

**–ê–≤—Ç–æ–∑–∞–ø—É—Å–∫:** –°–æ–∑–¥–∞–µ—Ç—Å—è systemd —Å–µ—Ä–≤–∏—Å `birdnet-device-check.service` –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ –ø–æ—Å–ª–µ –∑–∞–≥—Ä—É–∑–∫–∏.

**–ü—Ä–∏–º–µ—á–∞–Ω–∏–µ:** –ü–æ—Å–ª–µ –ø–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∫–∏ BirdNET-Go –æ–±—ã—á–Ω–æ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –≤—ã–±–∏—Ä–∞–µ—Ç –ø—Ä–∞–≤–∏–ª—å–Ω–æ–µ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–æ (`:2,0` - —Ç—Ä–µ—Ç—å–µ –≤ —Å–ø–∏—Å–∫–µ).

---

### –£—Å—Ç–∞–Ω–æ–≤–∫–∞

#### `setup_nanopi.sh`
**–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ:** –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è —É—Å—Ç–∞–Ω–æ–≤–∫–∞ –∏ –Ω–∞—Å—Ç—Ä–æ–π–∫–∞ –≤—Å–µ–π —Å–∏—Å—Ç–µ–º—ã –Ω–∞ NanoPi M4B.

**–ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ:**
```bash
chmod +x scripts/setup_nanopi.sh
sudo ./scripts/setup_nanopi.sh
```

**–ß—Ç–æ –¥–µ–ª–∞–µ—Ç:**
- –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ (Docker, SoX, ALSA, python3-scipy, python3-numpy)
- –ù–∞—Å—Ç—Ä–∞–∏–≤–∞–µ—Ç ReSpeaker
- –°–æ–∑–¥–∞–µ—Ç –≤—Å–µ –Ω–µ–æ–±—Ö–æ–¥–∏–º—ã–µ —Å–∫—Ä–∏–ø—Ç—ã –∏ —Å–µ—Ä–≤–∏—Å—ã
- –ö–æ–ø–∏—Ä—É–µ—Ç log_mmse_processor.py –≤ /usr/local/bin/
- –ù–∞—Å—Ç—Ä–∞–∏–≤–∞–µ—Ç BirdNET-Go

---

## üì¶ –£—Å—Ç–∞–Ω–æ–≤–∫–∞ —Å–∫—Ä–∏–ø—Ç–æ–≤ –Ω–∞ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–æ

–í—Å–µ —Å–∫—Ä–∏–ø—Ç—ã –¥–æ–ª–∂–Ω—ã –±—ã—Ç—å —Å–∫–æ–ø–∏—Ä–æ–≤–∞–Ω—ã –≤ `/usr/local/bin/` –∏ –∏–º–µ—Ç—å –ø—Ä–∞–≤–∞ –Ω–∞ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ:

```bash
# –ö–æ–ø–∏—Ä–æ–≤–∞–Ω–∏–µ –≤—Å–µ—Ö —Å–∫—Ä–∏–ø—Ç–æ–≤
sudo cp scripts/*.sh /usr/local/bin/
sudo cp scripts/*.py /usr/local/bin/
sudo chmod +x /usr/local/bin/*.sh
sudo chmod +x /usr/local/bin/*.py
```

## –°–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è

–ï—Å–ª–∏ –≤—ã –∏–∑–º–µ–Ω–∏–ª–∏ —Å–∫—Ä–∏–ø—Ç—ã –Ω–∞ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–µ, –æ–±–Ω–æ–≤–∏—Ç–µ –∏—Ö –≤ –ø—Ä–æ–µ–∫—Ç–µ:

```bash
# –° —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞ –Ω–∞ –∫–æ–º–ø—å—é—Ç–µ—Ä
scp root@192.168.1.136:/usr/local/bin/*.sh scripts/
```

–ï—Å–ª–∏ –≤—ã –∏–∑–º–µ–Ω–∏–ª–∏ —Å–∫—Ä–∏–ø—Ç—ã –≤ –ø—Ä–æ–µ–∫—Ç–µ, –æ–±–Ω–æ–≤–∏—Ç–µ –∏—Ö –Ω–∞ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–µ:

```bash
# –° –∫–æ–º–ø—å—é—Ç–µ—Ä–∞ –Ω–∞ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–æ
scp scripts/*.sh root@192.168.1.136:/usr/local/bin/
ssh root@192.168.1.136 "chmod +x /usr/local/bin/*.sh"
```

---

## –ü—Ä–∏–º–µ—á–∞–Ω–∏—è

- –í—Å–µ —Å–∫—Ä–∏–ø—Ç—ã –¥–æ–ª–∂–Ω—ã –∑–∞–ø—É—Å–∫–∞—Ç—å—Å—è –æ—Ç root –∏–ª–∏ —á–µ—Ä–µ–∑ sudo
- –°–∫—Ä–∏–ø—Ç—ã, —Å–≤—è–∑–∞–Ω–Ω—ã–µ —Å ReSpeaker, —Ç—Ä–µ–±—É—é—Ç –Ω–∞–ª–∏—á–∏—è `/root/usb_4_mic_array/`
- –°–∫—Ä–∏–ø—Ç—ã –ø—Ä–æ–≤–µ—Ä–∫–∏ –∏ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è —Ç—Ä–µ–±—É—é—Ç –∑–∞–ø—É—â–µ–Ω–Ω–æ–≥–æ Docker –∏ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞ `birdnet-go`
- –ü–æ—Å–ª–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è —Å–∫—Ä–∏–ø—Ç–æ–≤ –Ω–∞ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–µ –Ω–µ –∑–∞–±—É–¥—å—Ç–µ –æ–±–Ω–æ–≤–∏—Ç—å –∏—Ö –≤ –ø—Ä–æ–µ–∫—Ç–µ!

